<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>前端二进制学习</title>
</head>

<body>
    <input type="file" accept="image/*" onchange="loadFile(event)" />
    <input type="file" onchange="loadFile(event)" />
    <img id="previewContainer" />
    <!-- <img id="previewContainer2" src="https://avatars3.githubusercontent.com/u/4220799" /> -->

    <script>
        const loadFile = function (event) {
            // const reader = new FileReader();
            // reader.onload = function () {
            //     const output = document.querySelector("#previewContainer");
            //     console.log(reader.result);
            //     output.src = reader.result;
            // };
            // reader.readAsDataURL(event.target.files[0]);
            // reader.readAsArrayBuffer(event.target.files[0]);
            // reader.readAsBinaryString(event.target.files[0]);
            // reader.readAsText(event.target.files[0]);

            const image = document.querySelector("#previewContainer");
            const objectURL = URL.createObjectURL(event.target.files[0]);
            console.log('objectURL', objectURL);
            image.src = objectURL;
        };

        (function () {
            const reader = new FileReader();
            reader.onload = function () {
                console.log(reader.result);
            };
            let b = new Blob([12]);
            // console.log('arrayBuffer',b.slice(1,2).arrayBuffer());
            // console.log('stream',b.slice(1,2).stream());
            // let apromise = b.arrayBuffer();
            // console.log(apromise);
            // apromise.then(v=>{console.log(v);})

            // reader.readAsDataURL(b);
            // reader.readAsArrayBuffer(b);
            // reader.readAsBinaryString(b);
            // reader.readAsText(b);

            //在ASCII里，1的编码是49，对应的二进制为 00110001，所以base64是MQ==
            // console.log(btoa(1));//MQ==
        })();

        (() => {
            const image = document.querySelector("#previewContainer");
            fetch("https://avatars3.githubusercontent.com/u/4220799")
                .then((response) => {
                    // console.log('arrayBuffer',response.arrayBuffer());
                    return response.blob();
                })
                .then((blob) => {
                    // const objectURL = URL.createObjectURL(blob);
                    // console.log('objectURL', objectURL);
                    // image.src = objectURL;

                    // const reader = new FileReader();
                    // reader.onload = function () {
                    //     const output = document.querySelector("#previewContainer");
                    //     // console.log(reader.result);//base64
                    //     output.src = reader.result;
                    // };
                    // reader.readAsDataURL(blob);
                });
        })();

        //ArrayBuffer
        (() => {
            // let buffer = new ArrayBuffer(8)
            // console.log(buffer);

            // let view = new Int32Array(buffer);
            // console.log(view);
            // view[1] = 1; //通过TypedArray来修改ArrayBuffer
            // console.log(view);

            // new Blob([11111111]).arrayBuffer().then(buffer => {
            //     console.log(buffer);
            //     let view = new Int32Array(buffer);
            //     console.log(view);
            // });



            // let view = new Int8Array([49,49,49]); //49是1的ascii的编码
            // console.log(view);

            // const reader = new FileReader();
            // reader.onload = function () {
            //     console.log(reader.result);
            // };
            //  reader.readAsDataURL(new Blob([view.buffer]));
            // reader.readAsArrayBuffer(new Blob([view.buffer]));
            // reader.readAsBinaryString(new Blob([view.buffer]));
            // reader.readAsText(new Blob([view.buffer]));//111
            // console.log(view.buffer);

        })();

        //DataView
        (()=>{
            let buffer = new ArrayBuffer(2)

            let view = new DataView(buffer,1);
            view.setUint8(0,255);
            console.log(new Uint8Array(view.buffer));
            // console.log(view);
            // view[1] = 1; //通过TypedArray来修改ArrayBuffer
            // console.log(view);
        })();

    </script>
</body>

</html>